import{d as e,r as a,w as t,o as l,c as o,a as n,b as u,u as r,N as s,e as i,f as c,g as d,h as v,t as f,i as m,j as p,k as h,l as y,m as g,n as x,p as _,q as b,s as M,v as w}from"./vendor.96e6f4da.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const k=[[0,0,0],[255,255,255],[170,170,170],[85,85,85],[254,211,199],[255,196,206],[250,172,142],[255,139,131],[244,67,54],[233,30,99],[226,102,158],[156,39,176],[103,58,183],[63,81,181],[0,70,112],[5,113,151],[33,150,243],[0,188,212],[59,229,219],[151,253,220],[22,115,0],[55,169,60],[137,230,66],[215,255,7],[255,246,209],[248,203,140],[255,235,59],[255,193,7],[255,152,0],[255,87,34],[184,63,39],[121,85,72]];function A(e){const a=new WebSocket("wss://ws.luogu.com.cn/ws"),t=setTimeout((()=>a.close()),1e4);a.onopen=()=>{clearTimeout(t),a.send(JSON.stringify({type:"join_channel",channel:"paintboard"}))},a.onmessage=({data:a})=>{const t=JSON.parse(a);if("paintboard_update"===t.type){const{x:a,y:l,color:o}=t;e(a,l,o)}},a.onclose=()=>{clearTimeout(t),setTimeout((()=>A(e)),1e4)}}const N=["width","height"];var O=((e,a)=>{const t=e.__vccOpts||e;for(const[l,o]of a)t[l]=o;return t})(e({setup(e){const y=a(null),g=Array.from(Array(1e3),(()=>Array(600).fill(0))),x=Array.from(Array(1e3),(()=>Array(600).fill(2)));A((function(e,a,t){g[e][a]+=1,x[e][a]=t,setTimeout((()=>{g[e][a]-=1}),6e5)}));const _=(new Date).valueOf(),b=a(0),M=a(0),w=a(999),O=a(0),I=a(599);function S(){var e;const a=null==(e=y.value)?void 0:e.getContext("2d");if(!a)return;const t=a.createImageData(1e3,600),l=Math.max(1,g.reduce(((e,a)=>Math.max(e,a.reduce(((e,a)=>Math.max(e,Math.log(a?a+4:2))),0))),0));for(let o=0;o<1e3;o+=1)for(let e=0;e<600;e+=1){const a=4*(o+1e3*e);for(let n=0;n<3;n+=1)t.data[a+n]=k[x[o][e]][n]*(Math.log(g[o][e]?g[o][e]+4:2)/l);t.data[a+3]=255}b.value=0;for(let o=Math.min(M.value,w.value);o<=Math.max(M.value,w.value);o+=1)for(let e=Math.min(O.value,I.value);e<=Math.max(O.value,I.value);e+=1)b.value+=g[o][e];b.value*=3e4/Math.min((new Date).valueOf()-_,6e5),a.putImageData(t,0,0)}setInterval(S,1e3);const T={borderStyle:"solid",borderColor:"grey",borderWidth:"2px"},j=a(!0);function C(e){const a=y.value;if(!a)return;const t=a.getBoundingClientRect(),l=Math.floor(e.clientX-t.left-2),o=Math.floor(e.clientY-t.top-2);j.value?(M.value=l,O.value=o):(w.value=l,I.value=o),j.value=!j.value}function D(e,a){return Number.isFinite(e)?e<0?0:e>=a?a-1:Math.floor(e):0}return t(M,(e=>{M.value=D(e,1e3)})),t(w,(e=>{w.value=D(e,1e3)})),t(O,(e=>{O.value=D(e,600)})),t(I,(e=>{I.value=D(e,600)})),t([M,O,w,I],(()=>S())),(e,a)=>(l(),o(r(p),{id:"main",vertical:""},{default:n((()=>[u(r(s),{title:"洛谷冬日绘板热力图"}),u(r(m),{title:"计数"},{default:n((()=>[u(r(i),{label:"x1"},{default:n((()=>[u(r(c),{value:M.value,"onUpdate:value":a[0]||(a[0]=e=>M.value=e),min:0,max:r(1e3)-1},null,8,["value","max"])])),_:1}),u(r(i),{label:"y1"},{default:n((()=>[u(r(c),{value:O.value,"onUpdate:value":a[1]||(a[1]=e=>O.value=e),min:0,max:r(600)-1},null,8,["value","max"])])),_:1}),u(r(i),{label:"x2"},{default:n((()=>[u(r(c),{value:w.value,"onUpdate:value":a[2]||(a[2]=e=>w.value=e),min:0,max:r(1e3)-1},null,8,["value","max"])])),_:1}),u(r(i),{label:"y2"},{default:n((()=>[u(r(c),{value:I.value,"onUpdate:value":a[3]||(a[3]=e=>I.value=e),min:0,max:r(600)-1},null,8,["value","max"])])),_:1}),u(r(d),null,{default:n((()=>[v(" token 计数："+f(b.value.toFixed(2)),1)])),_:1})])),_:1}),u(r(m),{title:"热力图"},{default:n((()=>[u(r(p),{justify:"space-around"},{default:n((()=>[h("canvas",{ref_key:"canvas",ref:y,width:r(1e3),height:r(600),style:T,onClick:C},null,8,N)])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-5f4671ad"]]);w(e({setup(e){const a=y((()=>"dark"===b().value?M:null));return(e,t)=>(l(),o(r(g),{theme:r(a)},{default:n((()=>[u(r(x)),u(r(_),{closable:!0,"keep-alive-on-hover":!0,duration:5e3},{default:n((()=>[u(O)])),_:1})])),_:1},8,["theme"]))}})).mount("#app");
